Здесь записаны конвенции (не правила, а дополнительные договорённости)
к кооперативной настольной игре ханаби, которыми пользуются в околоспортивнопрограммистской компании.

Правила: https://ru.wikipedia.org/wiki/Ханаби

Удобный сайт для игры онлайн: https://hanabi.live/

# Основные конвенции

0. («Нулевая конвенция») С тобой играют не идиоты, им можно и нужно доверять.
Кстати, они видят твои карты, не то что ты сам.

1. Когда другие люди видят твои карты, читая слева направо, они видят карты от старой к новой.
На сайте https://hanabi.live/ — наоборот.

1. Показали серию — по умолчанию ходи этим, начиная от новой к старой.

1. Если при не до конца выложенной текущей серии тебе сообщают новую серию, которой можно ходить,
то она «перебивает» старую серию, и выкладывать старую до конца уже не нужно.
Если новая совпадает со старой, видимо, на тебя потратили подсказку, чтобы сказать «остановись».
Если новая является подмножеством старой, то это, видимо, умное уточнение порядка выкладывания внутри старой серии.
Если одно и то же множество карт показали два раза, видимо, имеется в виду порядок выкладывания от старой к новой.

1. Если сбрасываешь, то самую старую карту из тех, про которые ты не можешь себе доказать, что их нельзя сбрасывать.
Если про старую карту есть много информации, то даже хотя её формально можно сбрасывать, можно рассмотреть
вариант не сбрасывать её и передвинуть сброс на более новую.

1. Если подсказанная серия задевает карту, планируемую на сброс, то проверь гипотезу, что это
оберегающая подсказка, означающая, что одну или несколько старых карт надо беречь.
Также оберегающей подсказкой, видимо, является сообщение тебе серии карт, подсказывание которых
не получается трактовать как мотивацию к выкладыванию.

# Конвенция Дворкина—Мельникова

1. Если игроку сообщают серию карт, которую он воспримет как «ходи этим»,
но при этом эта серия не выкладывается сейчас из-за нехватки карт соответствующего цвета в пасьянсе,
то сидящий перед ним игрок «спасает» его от такого выкладывания тем,
что сам кладёт в пасьянс свою новую карту (либо это делают сразу несколько сидящим перед ним игроков).

1. Игроки сидящие перед тем, кому подсказали, делают такое спасение,
если выкладывание новой карты правильным подмножеством из них
успешно подложит необходимое число карт в соответствующий цвет в пасьянсе.
Если игрок видит, что даже без выкладывания им новой карты процесс спасения не кончится фейлом,
он исключает себя из подмножества тех, кому следует выкладывать новую.
При этом надо учитывать, что подсказчик мог «вытягивать» новые карты другого цвета («ложный Дворкин—Мельников»).

1. В этих рассуждениях если новая карта была ранее задета серией и не может спасти того, кому подсказали, от фейла,
то имеется в виду вытягивание не новой карты, а самой новой из тех, которые могут спасти.

1. Успешное применение ложного Дворкина—Мельникова является поводом всем запомнить, что
новая карта в серии, запустившей процесс, имеет соответствующее достоинство — единственно возможное для
запуска этого процесса — либо является радужной картой тоже с единственно возможным достоинством.

1. (Чьё авторство?) По аналогичной логике следуюет выкладывать свою новую карту (одному или нескольким игрокам),
если подсказка была по достоинству, карта этого достоинства в принципе выкладывается,
новая из подсказанных при этом не выкладывается, но нужное количество игроков перед получившим подсказку
могут положить свои новые карты и тогда к его ходу не будет цвета, в котором это достоинство выкладывается.

# Подсказывание по модулю в эндшпиле

1. Если в эндшпиле игроку, не имеющему подсказок, надо подсказать одному или нескольким людям, чем им ходить,
то он сбрасывает карту, позиция которой равна сумме позиций карт, которые он вытягивает, взятой по модулю
числа карт в руке. Новая карта это позиция 0, предновая — 1 и так далее.

1. В этом суммировании принимают участие карты тех игроков, которым есть что выкладывать, и у которых
до такого хода не было намерения выкладывать согласно предыдущим подсказкам.

1. Подсказывающий выбирает «траекторию выкладывания», приводящую к максимальному счёту.
Если таких несколько, выбирается та, в которой последний выкладывающий выкладывает наиболее новую карту.
При равенстве — та, в которой предпоследний выкладывающий выкладывает наиболее новую и так далее.

# Фокус на такой-то позиции

1. В ситуации, когда игроку не получается подсказать одну карту для выкладывания, возможна подсказка
другому игроку про совершенно странную карту на той же позиции
(хуже — на несколько странных карт, новая из которых — на той же позиции).
Желательно показывать следующему игроку после того, кому адресована подсказка.
Точно надо убедиться, что понять подсказку иначе невозможно.

1. («Сообразите на троих») Можно также применить фокусирование на позиции в ситуации,
когда надо вытянуть для выкладывания карты с одной и той же позиции у хотя бы трёх игроков. 
Каждый игрок убеждается по картам других не менее чем двух игроков, что имеется в виду именно этот приём,
и выкладывает карту с этой позиции.

1. («Сумасшествие») Для фокусирования на позиции также можно «сделать ход» своей картой из этой позиции.
Для этого надо сделать этой картой действие как минимум на один уровень безумия большее, чем ожидается:
если эту карту странно даже сбрасывать, то сбросить;
если эту карту адекватно сбрасывать, но странно ей ходить в пасьянс, то походить в пасьянс.

1. Есть суеверие, что сбрасывание новой карты ради вытягивания новой карты из всех остальных
непременно попадает на безопасную для сброса карту: пятёрки и радужные избегают таких мест :)

1. Если ты дочитал до этого места, вероятно, ты хочешь добавиться в телеграм-чат любителей ханаби,
для этого сообщи о таком желании кому-нибудь, упомянутому в этом документе.

# [Розовая масть](https://github.com/Zamiell/hanabi-live/blob/master/docs/VARIANTS.md#pink)

1. (Конвенция «first()») Подсказываем про множество розовых карт достоинство самой новой из них,
затем следущей по новизне и так далее.
При этом если для хода, задевающего розовые карты, выбор достоинства был продиктован
наличием не розовой карты этого достоинства, этот ход мог и не быть first()-ходом.

2. (Конвенция «get()») Когда надо вытянуть для выкладывания розовую карту из человека,
у которого их не менее двух, то ему сообщают достоинтсво, равное номеру позиции вытягиваемой карты
в нумерации: старая — 1, предстарая — 2 и так далее.

3. (Конвенция «try catch») Игрок, обладающий розовыми картами, понимает подсказки, касающиеся их, так:
если это можно объяснить как «first()», полезный для дела, то это именно он, иначе это «get()».
